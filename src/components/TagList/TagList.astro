---
import { getCollection } from "astro:content"
// const tags = await getCollection("tags")
const allPosts = await getCollection("blog")
const tags = Object.entries(
    allPosts
        .map((post) => {
            return post.data.tags
        })
        .flat()
        .sort()
        .reduce((acc: any, tag) => {
            if (acc[tag]) acc[tag] += 1
            else acc[tag] = 1
            return acc
        }, {})
)
---

<div class="flex w-full gap-2">
    <div class="left-arrow"></div>
    <ul class="flex-grow flex gap-2 overflow-x-auto p-10 -m-10">
        {
            tags.map(([label, count]) => (
                <li>
                    <a href={"tags/" + label} class="flex">
                        <p class="bg-blue-desaturated text-blue-accent border-r-2 border-offwhite text-glow-sm-blue-accent min-w-[2.5ch] text-center">
                            {count}
                        </p>
                        <p class="bg-gray-faded">{label}</p>
                    </a>
                </li>
            ))
        }
    </ul>
    <div class="right-arrow"></div>
</div>

<style>
    p {
        @apply text-offwhite font-nasa p-1 uppercase;
    }

    .left-arrow {
        @apply w-8 my-2 bg-offwhite;
        clip-path: polygon(0 50%, 100% 0, 100% 100%);
    }

    .right-arrow {
        @apply w-8 my-2 bg-offwhite;
        clip-path: polygon(0 0, 0 100%, 100% 50%);
    }

    li:hover {
        box-shadow: 0 0 8px 2px theme(colors.gray.light);
    }
</style>
